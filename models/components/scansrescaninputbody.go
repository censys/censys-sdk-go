// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package components

import (
	"encoding/json"
	"errors"
	"fmt"
	"github.com/censys/censys-sdk-go/internal/utils"
)

type TargetWebOrigin struct {
	// Hostname of the web origin
	Hostname string `json:"hostname"`
	// Port number of the web origin
	Port int `json:"port"`
}

func (t TargetWebOrigin) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(t, "", false)
}

func (t *TargetWebOrigin) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &t, "", false, []string{"hostname", "port"}); err != nil {
		return err
	}
	return nil
}

func (t *TargetWebOrigin) GetHostname() string {
	if t == nil {
		return ""
	}
	return t.Hostname
}

func (t *TargetWebOrigin) GetPort() int {
	if t == nil {
		return 0
	}
	return t.Port
}

// Two - Rescan of known web property
type Two struct {
	WebOrigin TargetWebOrigin `json:"web_origin"`
}

func (t Two) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(t, "", false)
}

func (t *Two) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &t, "", false, []string{"web_origin"}); err != nil {
		return err
	}
	return nil
}

func (t *Two) GetWebOrigin() TargetWebOrigin {
	if t == nil {
		return TargetWebOrigin{}
	}
	return t.WebOrigin
}

type TargetTransportProtocol string

const (
	TargetTransportProtocolUnknown TargetTransportProtocol = "unknown"
	TargetTransportProtocolTCP     TargetTransportProtocol = "tcp"
	TargetTransportProtocolUDP     TargetTransportProtocol = "udp"
	TargetTransportProtocolIcmp    TargetTransportProtocol = "icmp"
	TargetTransportProtocolQuic    TargetTransportProtocol = "quic"
)

func (e TargetTransportProtocol) ToPointer() *TargetTransportProtocol {
	return &e
}
func (e *TargetTransportProtocol) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "unknown":
		fallthrough
	case "tcp":
		fallthrough
	case "udp":
		fallthrough
	case "icmp":
		fallthrough
	case "quic":
		*e = TargetTransportProtocol(v)
		return nil
	default:
		return fmt.Errorf("invalid value for TargetTransportProtocol: %v", v)
	}
}

type TargetServiceID struct {
	// IP address of service
	IP string `json:"ip"`
	// Port number of service
	Port int `json:"port"`
	// Name of service protocol
	Protocol          string                  `json:"protocol"`
	TransportProtocol TargetTransportProtocol `json:"transport_protocol"`
}

func (t TargetServiceID) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(t, "", false)
}

func (t *TargetServiceID) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &t, "", false, []string{"ip", "port", "protocol", "transport_protocol"}); err != nil {
		return err
	}
	return nil
}

func (t *TargetServiceID) GetIP() string {
	if t == nil {
		return ""
	}
	return t.IP
}

func (t *TargetServiceID) GetPort() int {
	if t == nil {
		return 0
	}
	return t.Port
}

func (t *TargetServiceID) GetProtocol() string {
	if t == nil {
		return ""
	}
	return t.Protocol
}

func (t *TargetServiceID) GetTransportProtocol() TargetTransportProtocol {
	if t == nil {
		return TargetTransportProtocol("")
	}
	return t.TransportProtocol
}

// One - Rescan of known service
type One struct {
	ServiceID TargetServiceID `json:"service_id"`
}

func (o One) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(o, "", false)
}

func (o *One) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &o, "", false, []string{"service_id"}); err != nil {
		return err
	}
	return nil
}

func (o *One) GetServiceID() TargetServiceID {
	if o == nil {
		return TargetServiceID{}
	}
	return o.ServiceID
}

type ScansRescanInputBodyTargetType string

const (
	ScansRescanInputBodyTargetTypeOne ScansRescanInputBodyTargetType = "1"
	ScansRescanInputBodyTargetTypeTwo ScansRescanInputBodyTargetType = "2"
)

type ScansRescanInputBodyTarget struct {
	One *One `queryParam:"inline,name=target"`
	Two *Two `queryParam:"inline,name=target"`

	Type ScansRescanInputBodyTargetType
}

func CreateScansRescanInputBodyTargetOne(one One) ScansRescanInputBodyTarget {
	typ := ScansRescanInputBodyTargetTypeOne

	return ScansRescanInputBodyTarget{
		One:  &one,
		Type: typ,
	}
}

func CreateScansRescanInputBodyTargetTwo(two Two) ScansRescanInputBodyTarget {
	typ := ScansRescanInputBodyTargetTypeTwo

	return ScansRescanInputBodyTarget{
		Two:  &two,
		Type: typ,
	}
}

func (u *ScansRescanInputBodyTarget) UnmarshalJSON(data []byte) error {

	var one One = One{}
	if err := utils.UnmarshalJSON(data, &one, "", true, nil); err == nil {
		u.One = &one
		u.Type = ScansRescanInputBodyTargetTypeOne
		return nil
	}

	var two Two = Two{}
	if err := utils.UnmarshalJSON(data, &two, "", true, nil); err == nil {
		u.Two = &two
		u.Type = ScansRescanInputBodyTargetTypeTwo
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for ScansRescanInputBodyTarget", string(data))
}

func (u ScansRescanInputBodyTarget) MarshalJSON() ([]byte, error) {
	if u.One != nil {
		return utils.MarshalJSON(u.One, "", true)
	}

	if u.Two != nil {
		return utils.MarshalJSON(u.Two, "", true)
	}

	return nil, errors.New("could not marshal union type ScansRescanInputBodyTarget: all fields are null")
}

type ScansRescanInputBody struct {
	Target ScansRescanInputBodyTarget `json:"target"`
}

func (s *ScansRescanInputBody) GetTarget() ScansRescanInputBodyTarget {
	if s == nil {
		return ScansRescanInputBodyTarget{}
	}
	return s.Target
}
