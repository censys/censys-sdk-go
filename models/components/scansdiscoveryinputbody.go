// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package components

import (
	"errors"
	"fmt"
	"github.com/censys/censys-sdk-go/internal/utils"
)

type HostnamePort struct {
	// Hostname to scan
	Hostname string `json:"hostname"`
	// Port number to scan
	Port int `json:"port"`
}

func (h HostnamePort) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(h, "", false)
}

func (h *HostnamePort) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &h, "", false, []string{"hostname", "port"}); err != nil {
		return err
	}
	return nil
}

func (h *HostnamePort) GetHostname() string {
	if h == nil {
		return ""
	}
	return h.Hostname
}

func (h *HostnamePort) GetPort() int {
	if h == nil {
		return 0
	}
	return h.Port
}

// Target2 - Discovery scan against hostname:PORT
type Target2 struct {
	HostnamePort HostnamePort `json:"hostname_port"`
}

func (t Target2) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(t, "", false)
}

func (t *Target2) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &t, "", false, []string{"hostname_port"}); err != nil {
		return err
	}
	return nil
}

func (t *Target2) GetHostnamePort() HostnamePort {
	if t == nil {
		return HostnamePort{}
	}
	return t.HostnamePort
}

type HostPort struct {
	// IP address to scan
	IP string `json:"ip"`
	// Port number to scan
	Port int `json:"port"`
}

func (h HostPort) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(h, "", false)
}

func (h *HostPort) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &h, "", false, []string{"ip", "port"}); err != nil {
		return err
	}
	return nil
}

func (h *HostPort) GetIP() string {
	if h == nil {
		return ""
	}
	return h.IP
}

func (h *HostPort) GetPort() int {
	if h == nil {
		return 0
	}
	return h.Port
}

// Target1 - Discovery scan against IP:PORT
type Target1 struct {
	HostPort HostPort `json:"host_port"`
}

func (t Target1) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(t, "", false)
}

func (t *Target1) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &t, "", false, []string{"host_port"}); err != nil {
		return err
	}
	return nil
}

func (t *Target1) GetHostPort() HostPort {
	if t == nil {
		return HostPort{}
	}
	return t.HostPort
}

type ScansDiscoveryInputBodyTargetType string

const (
	ScansDiscoveryInputBodyTargetTypeTarget1 ScansDiscoveryInputBodyTargetType = "target_1"
	ScansDiscoveryInputBodyTargetTypeTarget2 ScansDiscoveryInputBodyTargetType = "target_2"
)

type ScansDiscoveryInputBodyTarget struct {
	Target1 *Target1 `queryParam:"inline,name=target" union:"member"`
	Target2 *Target2 `queryParam:"inline,name=target" union:"member"`

	Type ScansDiscoveryInputBodyTargetType
}

func CreateScansDiscoveryInputBodyTargetTarget1(target1 Target1) ScansDiscoveryInputBodyTarget {
	typ := ScansDiscoveryInputBodyTargetTypeTarget1

	return ScansDiscoveryInputBodyTarget{
		Target1: &target1,
		Type:    typ,
	}
}

func CreateScansDiscoveryInputBodyTargetTarget2(target2 Target2) ScansDiscoveryInputBodyTarget {
	typ := ScansDiscoveryInputBodyTargetTypeTarget2

	return ScansDiscoveryInputBodyTarget{
		Target2: &target2,
		Type:    typ,
	}
}

func (u *ScansDiscoveryInputBodyTarget) UnmarshalJSON(data []byte) error {

	var target1 Target1 = Target1{}
	if err := utils.UnmarshalJSON(data, &target1, "", true, nil); err == nil {
		u.Target1 = &target1
		u.Type = ScansDiscoveryInputBodyTargetTypeTarget1
		return nil
	}

	var target2 Target2 = Target2{}
	if err := utils.UnmarshalJSON(data, &target2, "", true, nil); err == nil {
		u.Target2 = &target2
		u.Type = ScansDiscoveryInputBodyTargetTypeTarget2
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for ScansDiscoveryInputBodyTarget", string(data))
}

func (u ScansDiscoveryInputBodyTarget) MarshalJSON() ([]byte, error) {
	if u.Target1 != nil {
		return utils.MarshalJSON(u.Target1, "", true)
	}

	if u.Target2 != nil {
		return utils.MarshalJSON(u.Target2, "", true)
	}

	return nil, errors.New("could not marshal union type ScansDiscoveryInputBodyTarget: all fields are null")
}

type ScansDiscoveryInputBody struct {
	Target ScansDiscoveryInputBodyTarget `json:"target"`
}

func (s *ScansDiscoveryInputBody) GetTarget() ScansDiscoveryInputBodyTarget {
	if s == nil {
		return ScansDiscoveryInputBodyTarget{}
	}
	return s.Target
}
